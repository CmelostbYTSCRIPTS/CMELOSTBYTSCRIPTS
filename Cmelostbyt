local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")
local HttpService = game:GetService("HttpService")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- –û—á–∏—Å—Ç–∫–∞
pcall(function() CoreGui.MoonHubUI:Destroy() end)
pcall(function() Workspace.MoonHubVisuals:Destroy() end)
pcall(function() makefolder("MoonHubConfigs") end)

-- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
local MaxPositions = 30
local ToolNameToEquip = "Speed Coil" -- –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞ –¥–ª—è —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
local SavedPositions = {}
local currentSaveSlot = 1
local resetPoint = 0 -- 0 = –≤—ã–∫–ª—é—á–µ–Ω–æ
local isCycling = false
local autoRestartAfterDeath = false
local lastUsedDirection = "forward"
local isTimerRunning = false -- –ù–û–í–û–ï: —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
local timerCoroutine = nil -- –ù–û–í–û–ï: –¥–ª—è –æ—Ç–º–µ–Ω—ã —Ç–∞–π–º–µ—Ä–∞

-- –ü–∞–ø–∫–∞ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∏—Ä–µ
local VisualsFolder = Instance.new("Folder", Workspace)
VisualsFolder.Name = "MoonHubVisuals"

-- === –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ï–î–ú–ï–¢–û–ú ===
local function EquipSpeedCoil()
	local Char = LocalPlayer.Character
	local Humanoid = Char and Char:FindFirstChildOfClass("Humanoid")
	if not Humanoid then return end

	local toolInBackpack = LocalPlayer.Backpack:FindFirstChild(ToolNameToEquip)
	if toolInBackpack then
		Humanoid:EquipTool(toolInBackpack)
	end
end

local function UnequipSpeedCoil()
	local Char = LocalPlayer.Character
	if not Char then return end
	
	local currentTool = Char:FindFirstChildOfClass("Tool")
	if currentTool and currentTool.Name == ToolNameToEquip then
		currentTool.Parent = LocalPlayer.Backpack
	end
end

-- === –°–û–ó–î–ê–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ===
-- ... (–≤–µ—Å—å –∫–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è UI –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º, —è –µ–≥–æ —Å–∫—Ä—ã–ª –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏, –Ω–æ –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–¥–µ—Å—å)
local MoonHubUI = Instance.new("ScreenGui")
MoonHubUI.Name = "MoonHubUI"
MoonHubUI.ResetOnSpawn = false
MoonHubUI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
MoonHubUI.Parent = pcall(function() return CoreGui end) and CoreGui or LocalPlayer:WaitForChild("PlayerGui")
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 300, 0, 520) -- –£–≤–µ–ª–∏—á–∏–ª –≤—ã—Å–æ—Ç—É
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -260) -- –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–ª –ø–æ–∑–∏—Ü–∏—é
MainFrame.BackgroundColor3 = Color3.fromRGB(12, 12, 18)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = MoonHubUI
MainFrame.Active = true
MainFrame.Draggable = true
local MainCorner = Instance.new("UICorner", MainFrame)
MainCorner.CornerRadius = UDim.new(0, 10)
local MainStroke = Instance.new("UIStroke", MainFrame)
MainStroke.Color = Color3.fromRGB(60, 60, 80)
MainStroke.Thickness = 1
MainStroke.Transparency = 0.5
local TopBar = Instance.new("Frame", MainFrame)
TopBar.Size = UDim2.new(1, 0, 0, 32)
TopBar.BackgroundColor3 = Color3.fromRGB(18, 18, 25)
TopBar.BorderSizePixel = 0
local TopBarCorner = Instance.new("UICorner", TopBar)
TopBarCorner.CornerRadius = UDim.new(0, 10)
local TopBarFix = Instance.new("Frame", TopBar)
TopBarFix.Size = UDim2.new(1, 0, 0.5, 0)
TopBarFix.Position = UDim2.new(0, 0, 0.5, 0)
TopBarFix.BackgroundColor3 = Color3.fromRGB(18, 18, 25)
TopBarFix.BorderSizePixel = 0
local AccentLine = Instance.new("Frame", TopBar)
AccentLine.Size = UDim2.new(0.3, 0, 0, 2)
AccentLine.Position = UDim2.new(0.35, 0, 1, -2)
AccentLine.BackgroundColor3 = Color3.fromRGB(80, 60, 120)
AccentLine.BorderSizePixel = 0
local TitleLabel = Instance.new("TextLabel", TopBar)
TitleLabel.Size = UDim2.new(1, 0, 1, 0)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Text = "MoonHub"
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.TextSize = 14
TitleLabel.TextColor3 = Color3.fromRGB(180, 180, 190)
local ContentFrame = Instance.new("Frame", MainFrame)
ContentFrame.Size = UDim2.new(1, -24, 1, -42)
ContentFrame.Position = UDim2.new(0, 12, 0, 38)
ContentFrame.BackgroundTransparency = 1
local function CreateStyledButton(text, position, parent)
	parent = parent or ContentFrame
	local button = Instance.new("TextButton", parent)
	button.Size = UDim2.new(1, 0, 0, 36)
	button.Position = position
	button.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
	button.Text = text
	button.Font = Enum.Font.GothamMedium
	button.TextSize = 13
	button.TextColor3 = Color3.fromRGB(150, 150, 160)
	button.AutoButtonColor = true
	local corner = Instance.new("UICorner", button)
	corner.CornerRadius = UDim.new(0, 6)
	local stroke = Instance.new("UIStroke", button)
	stroke.Color = Color3.fromRGB(50, 50, 65)
	stroke.Thickness = 1
	stroke.Transparency = 0.5
	button.MouseEnter:Connect(function() if button.AutoButtonColor then TweenService:Create(button, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(35, 35, 50)}):Play() end end)
	button.MouseLeave:Connect(function() if button.AutoButtonColor then TweenService:Create(button, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(25, 25, 35)}):Play() end end)
	return button
end
local function CreateTextBox(placeholder, position, parent)
	parent = parent or ContentFrame
	local box = Instance.new("TextBox", parent)
	box.Size = UDim2.new(1, 0, 0, 30)
	box.Position = position
	box.BackgroundColor3 = Color3.fromRGB(18, 18, 25)
	box.Font = Enum.Font.Gotham
	box.TextSize = 12
	box.TextColor3 = Color3.fromRGB(180, 180, 190)
	box.PlaceholderText = placeholder
	box.PlaceholderColor3 = Color3.fromRGB(80, 80, 90)
	box.TextXAlignment = Enum.TextXAlignment.Left
	box.ClearTextOnFocus = false
	local corner = Instance.new("UICorner", box)
	corner.CornerRadius = UDim.new(0, 6)
	local padding = Instance.new("UIPadding", box)
	padding.PaddingLeft = UDim.new(0, 10)
	padding.PaddingRight = UDim.new(0, 10)
	return box
end
local StatusLabel = Instance.new("TextLabel", ContentFrame)
StatusLabel.Size = UDim2.new(1, 0, 0, 18)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "Waiting for action..."
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextSize = 12
StatusLabel.TextColor3 = Color3.fromRGB(100, 100, 110)
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
local SaveButton = CreateStyledButton("–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–∑. 1/" .. MaxPositions, UDim2.new(0, 0, 0, 28))
SaveButton.AutoButtonColor = false
local CycleForwardButton = CreateStyledButton("–ù–∞—á–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç", UDim2.new(0, 0, 0, 72))
local CycleBackwardButton = CreateStyledButton("–ú–∞—Ä—à—Ä—É—Ç –Ω–∞–∑–∞–¥", UDim2.new(0, 0, 0, 114))
local StopCycleButton = CreateStyledButton("–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å", UDim2.new(0, 0, 0, 72)) -- –ü–æ–∑–∏—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞, –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω –≤–º–µ—Å—Ç–æ –¥—Ä—É–≥–∏—Ö –∫–Ω–æ–ø–æ–∫
local ClearButton = CreateStyledButton("–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ", UDim2.new(0, 0, 0, 156))
StopCycleButton.Visible = false
StopCycleButton.BackgroundColor3 = Color3.fromRGB(80, 40, 40)
StopCycleButton.AutoButtonColor = false -- –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ—Ü–≤–µ—Ç –¥–ª—è —Å—Ç–æ–ø-–∫–Ω–æ–ø–∫–∏

-- –ù–û–í–´–ï –≠–õ–ï–ú–ï–ù–¢–´ –¢–ê–ô–ú–ï–†–ê
local TimerInput = CreateTextBox("0", UDim2.new(0, 0, 0, 200))
TimerInput.Size = UDim2.new(0.5, -5, 0, 30)
TimerInput.PlaceholderText = "–¢–∞–π–º–µ—Ä (–º–∏–Ω—É—Ç—ã)"
local StartTimerButton = CreateStyledButton("–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å —Ç–∞–π–º–µ—Ä–æ–º", UDim2.new(0.5, 5, 0, 197))
StartTimerButton.Size = UDim2.new(0.5, -5, 0, 36)

local ResetPointLabel = Instance.new("TextLabel", ContentFrame)
ResetPointLabel.Size = UDim2.new(0.6, 0, 0, 20)
ResetPointLabel.Position = UDim2.new(0, 0, 0, 244) -- –ü–æ–∑–∏—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞
ResetPointLabel.BackgroundTransparency = 1
ResetPointLabel.Font = Enum.Font.Gotham
ResetPointLabel.Text = "–¢–æ—á–∫–∞ —Ä–µ—Å–µ—Ç–∞ (0 = –≤—ã–∫–ª):"
ResetPointLabel.TextSize = 11
ResetPointLabel.TextColor3 = Color3.fromRGB(120, 120, 130)
ResetPointLabel.TextXAlignment = Enum.TextXAlignment.Left
local ResetPointInput = CreateTextBox("0", UDim2.new(0.65, 0, 0, 239)) -- –ü–æ–∑–∏—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞
ResetPointInput.Size = UDim2.new(0.35, 0, 0, 28)
local ConfigNameInput = CreateTextBox("–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞...", UDim2.new(0, 0, 0, 279)) -- –ü–æ–∑–∏—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞
ConfigNameInput.Size = UDim2.new(1, -52, 0, 30)
local SaveConfigButton = CreateStyledButton("üíæ", UDim2.new(1, -46, 0, 276)) -- –ü–æ–∑–∏—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞
SaveConfigButton.Size = UDim2.new(0, 46, 0, 36)
local ConfigList = Instance.new("ScrollingFrame", ContentFrame)
ConfigList.Size = UDim2.new(1, -52, 0, 120)
ConfigList.Position = UDim2.new(0, 0, 0, 319) -- –ü–æ–∑–∏—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞
ConfigList.BackgroundColor3 = Color3.fromRGB(18, 18, 25)
ConfigList.BorderSizePixel = 0
ConfigList.CanvasSize = UDim2.new(0, 0, 0, 0)
ConfigList.ScrollBarThickness = 4
local listLayout = Instance.new("UIListLayout", ConfigList)
listLayout.Padding = UDim.new(0, 4)
listLayout.SortOrder = Enum.SortOrder.LayoutOrder
local RefreshConfigsButton = CreateStyledButton("üîÉ", UDim2.new(1, -46, 0, 316)) -- –ü–æ–∑–∏—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞
RefreshConfigsButton.Size = UDim2.new(0, 46, 0, 36)
local PositionLabel = Instance.new("TextLabel", ContentFrame)
PositionLabel.Size = UDim2.new(1, 0, 0, 16)
PositionLabel.Position = UDim2.new(0, 0, 1, -12)
PositionLabel.BackgroundTransparency = 1
PositionLabel.Text = "–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: 0 / " .. MaxPositions
PositionLabel.Font = Enum.Font.Gotham
PositionLabel.TextSize = 11
PositionLabel.TextColor3 = Color3.fromRGB(70, 70, 80)
PositionLabel.TextXAlignment = Enum.TextXAlignment.Center


-- === –õ–û–ì–ò–ö–ê ===
local function SetStatus(text, color, duration)
	StatusLabel.Text = text
	StatusLabel.TextColor3 = color or Color3.fromRGB(100, 100, 110)
	if duration then
		task.delay(duration, function()
			if StatusLabel.Text == text then -- –°–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
				StatusLabel.Text = "Waiting for action..."
				StatusLabel.TextColor3 = Color3.fromRGB(100, 100, 110)
			end
		end)
	end
end

-- ... (UpdateVisuals, –ª–æ–≥–∏–∫–∞ —Ç–æ—á–∫–∏ —Ä–µ—Å–µ—Ç–∞, –ª–æ–≥–∏–∫–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ—á–∫–∏ - –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
local function UpdateVisuals()
	VisualsFolder:ClearAllChildren()
	for i, pos in ipairs(SavedPositions) do
		local point = Instance.new("Part", VisualsFolder)
		point.Name = "MoonHub_VisualPoint_" .. i
		point.Shape = Enum.PartType.Ball
		point.Size = Vector3.new(1.5, 1.5, 1.5)
		point.Position = pos
		point.Anchored = true
		point.CanCollide = false
		point.CastShadow = false
		point.Material = Enum.Material.Neon
		point.Color = (i == resetPoint and resetPoint > 0) and Color3.fromRGB(255, 50, 50) or Color3.fromRGB(0, 255, 100)
		point.Transparency = 0.6
	end
end
ResetPointInput.FocusLost:Connect(function(enterPressed)
	local num = tonumber(ResetPointInput.Text)
	if num then
		resetPoint = math.clamp(math.floor(num), 0, #SavedPositions)
		ResetPointInput.Text = tostring(resetPoint)
		UpdateVisuals()
		SetStatus("–¢–æ—á–∫–∞ —Ä–µ—Å–µ—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ " .. resetPoint, Color3.fromRGB(80, 120, 90), 2)
	else
		ResetPointInput.Text = tostring(resetPoint)
	end
end)
local function RefreshConfigList()
	if not listfiles then SetStatus("–§—É–Ω–∫—Ü–∏—è listfiles –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞", Color3.fromRGB(140, 80, 80), 2) return end
	ConfigList:ClearAllChildren()
	local files = listfiles("MoonHubConfigs")
	for _, path in ipairs(files) do
		local name = path:match("([^/\\]+)%.json$")
		if name then
			local btn = CreateStyledButton(name, UDim2.new(), ConfigList)
			btn.Size = UDim2.new(1, 0, 0, 30)
			btn.TextSize = 11
			btn.MouseButton1Click:Connect(function()
				local success, result = pcall(function()
					local data = HttpService:JSONDecode(readfile(path))
					SavedPositions = {}
					for _, posData in ipairs(data.positions) do
						table.insert(SavedPositions, Vector3.new(posData.x, posData.y, posData.z))
					end
					resetPoint = data.resetPoint or 0
					UpdateVisuals()
					PositionLabel.Text = string.format("–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: %d / %d", #SavedPositions, MaxPositions)
					ResetPointInput.Text = tostring(resetPoint)
					currentSaveSlot = #SavedPositions + 1
					if currentSaveSlot > MaxPositions then currentSaveSlot = 1 end
					SaveButton.Text = string.format("–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–∑. %d/%d", currentSaveSlot, MaxPositions)
				end)
				if success then
					SetStatus("–ö–æ–Ω—Ñ–∏–≥ '"..name.."' –∑–∞–≥—Ä—É–∂–µ–Ω!", Color3.fromRGB(80, 120, 90), 2)
				else
					SetStatus("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥–∞", Color3.fromRGB(140, 80, 80), 2)
				end
			end)
		end
	end
end
SaveConfigButton.MouseButton1Click:Connect(function()
	if not writefile then SetStatus("–§—É–Ω–∫—Ü–∏—è writefile –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞", Color3.fromRGB(140, 80, 80), 2) return end
	local name = ConfigNameInput.Text
	if name == "" then SetStatus("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∫–æ–Ω—Ñ–∏–≥–∞", Color3.fromRGB(140, 80, 80), 2) return end
	
	local success, result = pcall(function()
		local dataToSave = {positions = {}, resetPoint = resetPoint}
		for _, pos in ipairs(SavedPositions) do table.insert(dataToSave.positions, {x = pos.X, y = pos.Y, z = pos.Z}) end
		writefile("MoonHubConfigs/"..name..".json", HttpService:JSONEncode(dataToSave))
	end)
	if success then
		SetStatus("–ö–æ–Ω—Ñ–∏–≥ '"..name.."' —Å–æ—Ö—Ä–∞–Ω–µ–Ω!", Color3.fromRGB(40, 60, 50), 2)
		RefreshConfigList()
	else SetStatus("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞", Color3.fromRGB(140, 80, 80), 2) end
end)
RefreshConfigsButton.MouseButton1Click:Connect(RefreshConfigList)
SaveButton.MouseButton1Click:Connect(function()
	local Char = LocalPlayer.Character
	if Char and Char.PrimaryPart then
		SavedPositions[currentSaveSlot] = Char.PrimaryPart.Position
		UpdateVisuals()
		TweenService:Create(SaveButton, TweenInfo.new(0.1), {BackgroundColor3 = Color3.fromRGB(40, 60, 50)}):Play()
		task.wait(0.2)
		TweenService:Create(SaveButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(25, 25, 35)}):Play()
		PositionLabel.Text = string.format("–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: %d / %d", #SavedPositions, MaxPositions)
		currentSaveSlot = #SavedPositions + 1
		if currentSaveSlot > MaxPositions then currentSaveSlot = 1 end
		SaveButton.Text = string.format("–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–∑. %d/%d", currentSaveSlot, MaxPositions)
	end
end)


ClearButton.MouseButton1Click:Connect(function()
	isCycling = false
	isTimerRunning = false
	if timerCoroutine then task.cancel(timerCoroutine); timerCoroutine = nil end
	UnequipSpeedCoil() -- –£–±–∏—Ä–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç
	SavedPositions = {}
	currentSaveSlot = 1
	resetPoint = 0
	UpdateVisuals()
	ResetPointInput.Text = "0"
	PositionLabel.Text = "–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: 0 / " .. MaxPositions
	SaveButton.Text = "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–∑. 1/" .. MaxPositions
	SetStatus("–í—Å–µ —Ç–æ—á–∫–∏ –æ—á–∏—â–µ–Ω—ã", nil, 2)
end)

local function StartCycle(initialDirection)
	lastUsedDirection = initialDirection
	if isCycling or isTimerRunning then return end
	if #SavedPositions < 2 then SetStatus("–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 —Ç–æ—á–∫–∏!", Color3.fromRGB(140, 80, 80), 2) return end

	isCycling = true
	
	-- –ò–ó–ú–ï–ù–ï–ù–û: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–Ω–æ–ø–æ–∫
	CycleForwardButton.Visible = false
	CycleBackwardButton.Visible = false
	StartTimerButton.Visible = false
	StopCycleButton.Visible = true
	TweenService:Create(AccentLine, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(70, 110, 80)}):Play()

	task.spawn(function()
		local Char = LocalPlayer.Character
		local Humanoid = Char and Char:FindFirstChildOfClass("Humanoid")
		
		if not Humanoid then isCycling = false return end
		
		local startIdx, endIdx, step
		if initialDirection == "forward" then
			startIdx, endIdx, step = 1, #SavedPositions, 1
			StatusLabel.Text = "–ò–¥—É –ø–æ –º–∞—Ä—à—Ä—É—Ç—É (—Ü–∏–∫–ª –≤–ø–µ—Ä–µ–¥)..."
		else
			startIdx, endIdx, step = #SavedPositions, 1, -1
			StatusLabel.Text = "–ò–¥—É –ø–æ –º–∞—Ä—à—Ä—É—Ç—É (—Ü–∏–∫–ª –Ω–∞–∑–∞–¥)..."
		end
		StatusLabel.TextColor3 = Color3.fromRGB(80, 120, 90)

		while isCycling and Humanoid and Humanoid.Health > 0 do
			for i = startIdx, endIdx, step do
				if not isCycling then break end
				
				local targetPos = SavedPositions[i]
				Humanoid:MoveTo(targetPos)

				local moveConnection
				local moveFinished = false
				moveConnection = Humanoid.MoveToFinished:Connect(function() moveFinished = true; moveConnection:Disconnect() end)
				
				-- –¶–∏–∫–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–µ–¥–º–µ—Ç–∞
				while not moveFinished and isCycling do
					local char = LocalPlayer.Character
					if char then
						local currentTool = char:FindFirstChildOfClass("Tool")
						if not currentTool or currentTool.Name ~= ToolNameToEquip then
							EquipSpeedCoil()
						end
					end
					task.wait()
				end
				if moveConnection.Connected then moveConnection:Disconnect() end

				if isCycling and i == resetPoint and resetPoint > 0 then
					autoRestartAfterDeath = true
					Humanoid.Health = 0
					break
				end
			end

			if isCycling and Char.PrimaryPart then
				Char.PrimaryPart.CFrame = CFrame.new(SavedPositions[startIdx])
				task.wait(0.1)
			end
		end
		
		UnequipSpeedCoil()
		isCycling = false
		CycleForwardButton.Visible = true
		CycleBackwardButton.Visible = true
		StartTimerButton.Visible = true
		StopCycleButton.Visible = false
		if not autoRestartAfterDeath then
			SetStatus("–ú–∞—Ä—à—Ä—É—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω", nil, 2)
			TweenService:Create(AccentLine, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 60, 120)}):Play()
		end
	end)
end

-- –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
local function formatTime(totalSeconds)
	local minutes = math.floor(totalSeconds / 60)
	local seconds = totalSeconds % 60
	return string.format("%02d:%02d", minutes, seconds)
end

-- –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê: –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
StartTimerButton.MouseButton1Click:Connect(function()
	if isCycling or isTimerRunning then return end
	if #SavedPositions < 2 then SetStatus("–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 —Ç–æ—á–∫–∏!", Color3.fromRGB(140, 80, 80), 2) return end

	local minutes = tonumber(TimerInput.Text)
	if not minutes or minutes <= 0 then
		SetStatus("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –≤—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö!", Color3.fromRGB(140, 80, 80), 2)
		return
	end

	isTimerRunning = true
	local endTime = tick() + minutes * 60

	-- –û–±–Ω–æ–≤–ª—è–µ–º UI
	CycleForwardButton.Visible = false
	CycleBackwardButton.Visible = false
	StartTimerButton.Visible = false
	StopCycleButton.Visible = true
	TweenService:Create(AccentLine, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(120, 100, 60)}):Play()

	timerCoroutine = task.spawn(function()
		while isTimerRunning and tick() < endTime do
			local timeLeft = math.max(0, endTime - tick())
			SetStatus("–°—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑: " .. formatTime(math.ceil(timeLeft)), Color3.fromRGB(150, 130, 90))
			task.wait(0.5)
		end

		-- –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —Ç–∞–π–º–µ—Ä –æ—Ç–º–µ–Ω–µ–Ω
		if isTimerRunning then
			isTimerRunning = false
			timerCoroutine = nil
			SetStatus("–¢–∞–π–º–µ—Ä –∑–∞–≤–µ—Ä—à–µ–Ω, –Ω–∞—á–∏–Ω–∞—é –º–∞—Ä—à—Ä—É—Ç...", Color3.fromRGB(80, 120, 90), 2)
			StartCycle(lastUsedDirection) -- –ù–∞—á–∏–Ω–∞–µ–º —Ü–∏–∫–ª —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
		end
	end)
end)


CycleForwardButton.MouseButton1Click:Connect(function() StartCycle("forward") end)
CycleBackwardButton.MouseButton1Click:Connect(function() StartCycle("backward") end)

-- –ò–ó–ú–ï–ù–ï–ù–û: –ö–Ω–æ–ø–∫–∞ —Å—Ç–æ–ø —Ç–µ–ø–µ—Ä—å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ —Ç–∞–π–º–µ—Ä
StopCycleButton.MouseButton1Click:Connect(function()
	local wasActive = isCycling or isTimerRunning
	
	isCycling = false
	autoRestartAfterDeath = false
	isTimerRunning = false
	if timerCoroutine then
		task.cancel(timerCoroutine)
		timerCoroutine = nil
	end
	
	UnequipSpeedCoil()
	
	-- –°–±—Ä–æ—Å UI
	CycleForwardButton.Visible = true
	CycleBackwardButton.Visible = true
	StartTimerButton.Visible = true
	StopCycleButton.Visible = false
	TweenService:Create(AccentLine, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 60, 120)}):Play()

	if wasActive then
		SetStatus("–î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ", nil, 2)
		pcall(function() StarterGui:SetCore("SendNotification", {Title = "MoonHub", Text = "–î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ", Duration = 2}) end)
	end
end)

LocalPlayer.CharacterAdded:Connect(function(char)
	isCycling = false
	isTimerRunning = false -- –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –ø—Ä–∏ —Å–º–µ—Ä—Ç–∏
	if timerCoroutine then task.cancel(timerCoroutine); timerCoroutine = nil end

	UnequipSpeedCoil()
	UpdateVisuals()
	
	-- –í–æ–∑–≤—Ä–∞—â–∞–µ–º UI –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –µ—Å–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂ —É–º–µ—Ä –≤–æ –≤—Ä–µ–º—è —Ü–∏–∫–ª–∞/—Ç–∞–π–º–µ—Ä–∞
	CycleForwardButton.Visible = true
	CycleBackwardButton.Visible = true
	StartTimerButton.Visible = true
	StopCycleButton.Visible = false
	TweenService:Create(AccentLine, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 60, 120)}):Play()

	task.wait(2)
	if autoRestartAfterDeath then
		autoRestartAfterDeath = false
		StartCycle(lastUsedDirection)
	end
	
	char:WaitForChild("Humanoid").Died:Connect(function()
		isCycling = false
		isTimerRunning = false
		if timerCoroutine then task.cancel(timerCoroutine); timerCoroutine = nil end
		UnequipSpeedCoil()
	end)
end)

-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∞–Ω–∏–º–∞—Ü–∏—è
RefreshConfigList()
-- –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Å–ø–∏—Å–æ–∫ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
local elementsToAnimate = {MainFrame, TopBar, AccentLine, TitleLabel, StatusLabel, SaveButton, CycleForwardButton, CycleBackwardButton, ClearButton, StopCycleButton, ResetPointLabel, ResetPointInput, ConfigNameInput, SaveConfigButton, ConfigList, RefreshConfigsButton, PositionLabel, TimerInput, StartTimerButton}
for _, el in pairs(elementsToAnimate) do
	if el:IsA("GuiObject") then pcall(function() el.BackgroundTransparency = 1 end) end
	if el:IsA("UIStroke") then pcall(function() el.Transparency = 1 end) end
	if el:IsA("TextLabel") or el:IsA("TextButton") or el:IsA("TextBox") then pcall(function() el.TextTransparency = 1 end) end
end
task.wait(0.2)
local function FadeIn(obj, duration, props) TweenService:Create(obj, TweenInfo.new(duration), props):Play() end
FadeIn(MainFrame, 0.4, {BackgroundTransparency = 0})
FadeIn(MainFrame:FindFirstChildOfClass("UIStroke"), 0.4, {Transparency = 0.5})
task.wait(0.1)
FadeIn(TopBar, 0.4, {BackgroundTransparency = 0})
FadeIn(AccentLine, 0.3, {BackgroundTransparency = 0})
FadeIn(TitleLabel, 0.3, {TextTransparency = 0})
task.wait(0.1)
FadeIn(StatusLabel, 0.25, {TextTransparency = 0})
-- –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –≤–∫–ª—é—á–∞—è –Ω–æ–≤—ã–µ
for _, el in pairs({SaveButton, CycleForwardButton, CycleBackwardButton, ClearButton, StopCycleButton, TimerInput, StartTimerButton, ResetPointLabel, ResetPointInput, ConfigNameInput, SaveConfigButton, ConfigList, RefreshConfigsButton, PositionLabel}) do
    task.wait(0.02)
    FadeIn(el, 0.2, {BackgroundTransparency = el.BackgroundTransparency - 1, TextTransparency = 0})
    local stroke = el:FindFirstChildOfClass("UIStroke")
    if stroke then FadeIn(stroke, 0.2, {Transparency = 0.5}) end
end
